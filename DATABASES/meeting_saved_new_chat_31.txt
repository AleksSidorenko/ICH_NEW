08:59:39 –û—Ç Alexander Golubenko –¥–æ –í—Å–µ:
	–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ
	Yevgeniy G:ü•≥
	
09:03:04 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	
	https://thisisdata.ru/blog/uchimsya-primenyat-okonnyye-funktsii/ - –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ 
	https://learn.microsoft.com/ru-ru/sql/t-sql/functions/ntile-transact-sql?view=sql-server-ver16 -  –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ NTILE –æ—Ç microsoft
	–î—Ä—É–≥–∏–µ —Å—Å—ã–ª–∫–∏ —Å —Ç–µ–æ—Ä–∏–µ–π –ø–æ –æ–∫–æ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º: 
	https://habr.com/ru/articles/664000/
	https://habr.com/ru/companies/otus/articles/490296/
	https://andreyex.ru/bazy-dannyx/baza-dannyx-mysql/mysql-okonnye-funktsii/
	Olha Dvornyk:üëç
	
09:32:14 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	–í—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –≥–æ—Ä–æ–¥–∞–º: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –≤—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–ª–∏–µ–Ω—Ç–æ–≤.
	
09:33:56 –û—Ç Oleksandr Kiselov –¥–æ –í—Å–µ:
	–∏–∑–≤–∏–Ω–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∞ –º–æ–∂–µ—Ç–µ —Å–Ω–æ–≤–∞ –Ω–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞?
	
09:34:09 –û—Ç Stanislav M. –¥–æ –í—Å–µ:
	–û–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
	hostname: ich-db.edu.itcareerhub.de
	username: ich1
	password: password
	–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –¥–æ—Å—Ç—É–ø–æ–º –Ω–∞ –∑–∞–ø–∏—Å—å:
	hostname: ich-edit.edu.itcareerhub.de
	MYSQL_USER: ich1
	MYSQL_PASSWORD: ich1_password_ilovedbs
	
09:34:48 –û—Ç Oleksandr Kiselov –¥–æ –í—Å–µ:
	—Å–ø–∞—Å–∏–±–æ
	Stanislav M.:üëç
	
09:39:32 –û—Ç Darina Trotska –¥–æ –í—Å–µ:
	–î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–ø–∞–¥–∞–µ—Ç –ø—Ä–∏ group by
	
09:43:23 –û—Ç Hanna Kulykovska –¥–æ –í—Å–µ:
	SELECT *
	FROM CUSTOMERS;
	
	SELECT *, ROUND(AVG(RATING) OVER(PARTITION BY CITY)) AS avarage_rate 
	FROM CUSTOMERS;
	
	SELECT *
	FROM CUSTOMERS AS cus
	LEFT JOIN (SELECT CITY, ROUND(AVG(RATING)) AS avarage_rate
	FROM CUSTOMERS
	GROUP BY CITY) AS avg_r ON cus.CITY = avg_r.CITY
	
09:50:24 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	–í—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º –∑–∞–∫–∞–∑–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É –∑–∞–∫–∞–∑–∞ –≤ —Ç–æ–º –∂–µ –º–µ—Å—è—Ü–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏.
	
09:54:12 –û—Ç Oleksandr Kiselov –¥–æ –í—Å–µ:
	select *, max(AMT) over(partition by month(ODATE)) 
	from ORDERS
	
09:56:08 –û—Ç Stanislav M. –¥–æ –í—Å–µ:
	—É–∂–µ –≤ —Ä–∞–º–µ –ø–æ—Å–ª–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ –±–¥?
	
09:56:15 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	–î–ª—è –±–æ–ª–µ–µ –ø–æ–ª–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –ø—Ä–æ—à–ª–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –¥–æ–±–∞–≤–∏–º –ø–æ–¥—Å—á–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤–∫–ª–∞–¥–∞ –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞ –≤ –æ–±—â–∏–π –æ–±—ä–µ–º –ø—Ä–æ–¥–∞–∂ –º–µ—Å—è—Ü–∞.
	
10:06:58 –û—Ç Vadym Prudnikov –¥–æ –í—Å–µ:
	-- –î–ª—è –±–æ–ª–µ–µ –ø–æ–ª–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –ø—Ä–æ—à–ª–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –¥–æ–±–∞–≤–∏–º –ø–æ–¥—Å—á–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ
	--  –≤–∫–ª–∞–¥–∞ –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞ –≤ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–¥–∞–∂–µ –≤ –º–µ—Å—è—Ü
	
	select *, max(AMT) over(partition by month(ODATE)),
	ROUND((AMT / max(AMT) over(partition by month(ODATE))) * 100, 2) AS "%"
	from ORDERS
	
10:07:35 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	–í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –æ–±—â–µ–π —Å—É–º–º—ã –∏—Ö –ø—Ä–æ–¥–∞–∂. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂.
	
10:08:37 –û—Ç Dmitro Averkiev –¥–æ –í—Å–µ:
	—á—É—Ç—å –ø–æ—Ö–∂–µ
	
10:15:01 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	https://www.w3schools.com/sql/func_sqlserver_coalesce.asp
	
10:16:55 –û—Ç Stanislav M. –¥–æ –í—Å–µ:
	–ø—Ä–æ–±–µ–ª –ø–æ—Å–ª–µ COALESCE ü•≤
	
10:17:02 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	https://www.w3schools.com/sql/func_sqlserver_isnull.asp
	
10:18:14 –û—Ç Klymentii Taran –¥–æ –í—Å–µ:
	select s.SELL_ID, s.SNAME, o.AMT,
	if (sum(o.AMT) over(partition by s.SELL_ID) is null, 0, sum(o.AMT) over(partition by s.SELL_ID)) sellers_sum
	from SELLERS s left join ORDERS o on s.SELL_ID = o.SELL_ID
	order by sellers_sum desc;
	
	
	select s.SELL_ID, s.SNAME, o.AMT,
	coalesce (sum(o.AMT) over(partition by s.SELL_ID), 0) sellers_sum # –¥–µ–ª–∞–µ—Ç –∏–∑ null –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
	from SELLERS s left join ORDERS o on s.SELL_ID = o.SELL_ID
	order by sellers_sum desc;
	
10:19:09 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	https://www.w3schools.com/sql/func_mysql_ifnull.asp
	
10:19:45 –û—Ç Klymentii Taran –¥–æ –í—Å–µ:
	select s.SELL_ID, s.SNAME, o.AMT,
	ifnull(sum(o.AMT) over(partition by s.SELL_ID), 0) sellers_sum
	from SELLERS s left join ORDERS o on s.SELL_ID = o.SELL_ID
	order by sellers_sum desc;
	
10:20:16 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	–í—ã–≤–µ—Å—Ç–∏ —Ç–æ–ø-2 –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ —Å —Å–∞–º–æ–π –≤—ã—Å–æ–∫–æ–π —Å—Ä–µ–¥–Ω–µ–π —Å—É–º–º–æ–π –∑–∞–∫–∞–∑–∞.
	
10:27:42 –û—Ç Vitali Salamatin –¥–æ –í—Å–µ:
	USE shop;
	SELECT t1.SNAME, AVG(t2.AMT)
	FROM SELLERS t1
	LEFT JOIN  ORDERS t2 ON t2.SELL_ID = t1.SELL_ID
	GROUP BY t1.SELL_ID
	ORDER BY AVG(t2.AMT) DESC
	LIMIT 2
	
10:34:26 –û—Ç Vitali Salamatin –¥–æ –í—Å–µ:
	SELECT t1.SNAME, AVG(t2.AMT) OVER (PARTITION BY t1.SELL_ID) as average_order, AMT
	FROM SELLERS t1
	LEFT JOIN  ORDERS t2 ON t2.SELL_ID = t1.SELL_ID
	ORDER BY average_order DESC
	
11:20:42 –û—Ç Darina Trotska –¥–æ –í—Å–µ:
	-
	
11:20:43 –û—Ç Hanna Kulykovska –¥–æ –í—Å–µ:
	+
	
11:20:44 –û—Ç Klymentii Taran –¥–æ –í—Å–µ:
	-
	
11:20:44 –û—Ç Olha Dvornyk –¥–æ –í—Å–µ:
	++++
	
11:20:46 –û—Ç Vitali Salamatin –¥–æ –í—Å–µ:
	+
	
11:20:46 –û—Ç Oleksandr Kiselov –¥–æ –í—Å–µ:
	+
	
11:20:47 –û—Ç Ayjemal Berdiyeva –¥–æ –í—Å–µ:
	-
	
11:20:48 –û—Ç Yevgeniy G –¥–æ –í—Å–µ:
	-
	
11:20:47 –û—Ç Dmitro Averkiev –¥–æ –í—Å–µ:
	-
	
11:20:56 –û—Ç Olena Marshalova –¥–æ –í—Å–µ:
	+
	
11:21:20 –û—Ç Stanislav M. –¥–æ –í—Å–µ:
	-
	
11:22:51 –û—Ç Hanna Kulykovska –¥–æ –í—Å–µ:
	–•–æ—Ä–æ—à–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —ç—Ç–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –Ω–∞—à–∏—Ö —á–∏—Å–µ–ª
	
11:25:08 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	–ø—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤ –ø–æ —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç–µ.
	
11:34:37 –û—Ç Yevgeniy G –¥–æ –í—Å–µ:
	SELECT department_id, ROUND(AVG(salary)) avg_sel, DENSE_RANK() OVER(ORDER BY AVG(salary) DESC) as rank_sel
	FROM employees
	GROUP BY department_id
	ORDER BY department_id;
	
11:34:44 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	–í—ã–≤–µ–¥–∏—Ç–µ —Ç–æ–ø 3 –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ –ø–æ —É—Ä–æ–≤–Ω—é —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç—ã:
	
11:38:13 –û—Ç Maksym Poliakov –¥–æ –í—Å–µ:
	having
	
	
	
11:38:45 –û—Ç Alex Sidorenko –¥–æ –í—Å–µ:
	Teil‚Ä¶
	
11:45:55 –û—Ç Dmitro Averkiev –¥–æ –í—Å–µ:
	—Å–∫–∏–Ω—å —Ä–µ—à–µ–Ω–∏–µ –ø–ª–∏–∑
	
11:47:19 –û—Ç Yevgeniy G –¥–æ –í—Å–µ:
	SELECT *
	FROM (SELECT department_id, ROUND(AVG(salary)) avg_sel, DENSE_RANK()OVER(ORDER BY AVG(salary) DESC) as rank_sel
	FROM employees
	GROUP BY department_id) t1
	WHERE rank_sel <= 3;
	
11:48:02 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	–í—ã–≤–µ—Å—Ç–∏ –≤—Å–µ—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç 2 –º–µ—Å—Ç–æ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é —Ä–µ–π—Ç–∏–Ω–≥–∞.
	
11:56:32 –û—Ç Teacher 23 Teacher 23 –¥–æ –í—Å–µ:
	–í—ã–≤–µ–¥–∏—Ç–µ –≤—Ç–æ—Ä–æ–≥–æ –ø–æ –∑–∞—Ä–ø–ª–∞—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤ –∫–∞–∂–¥–æ–º –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–µ.
	
11:56:48 –û—Ç Alex Sidorenko –¥–æ –í—Å–µ:
	SELECT * FROM 
	(SELECT CNAME, RATING, DENSE_RANK() OVER(ORDER BY RATING DESC) AS rang
	FROM CUSTOMERS) AS t
	WHERE rang = 2
	
