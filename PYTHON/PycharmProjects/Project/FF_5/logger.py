# logger.py
# Модуль для логирования поисковых запросов
# Не использует базу данных — все данные хранятся в оперативной памяти (временные, сбрасываются при перезапуске)

from collections import Counter  # Импортируем Counter для подсчета количества одинаковых строк

# Глобальная переменная — словарь, считающий количество повторов каждого поискового запроса
query_log_memory = Counter()

# Функция логирования запроса
def log_query(query: str):
    # Приводим запрос к нижнему регистру и убираем пробелы в начале/конце
    normalized_query = query.strip().lower()
    # Увеличиваем счётчик этого запроса
    query_log_memory[normalized_query] += 1

# Функция получения самых популярных запросов
def get_top_queries(limit=10):
    # Возвращаем список самых частых запросов (по убыванию)
    return query_log_memory.most_common(limit)

# Примечание:
# В этом модуле нет подключения к базе данных, поэтому SQL-инъекции невозможны по определению.
# Все данные — чисто текстовые и обрабатываются безопасными встроенными средствами Python.
